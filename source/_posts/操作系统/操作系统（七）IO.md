---
title: 操作系统（七）IO
date: 2020-10-29 21:18:09
tags: 
    - 操作系统
categories:
    - 计算机基础知识
    - 操作系统
---
## IO管理

### 设备分类

#### 按传输速率分
1. 低速：如键盘、鼠标
2. 中速：如行式打印机、激光打印机
3. 高速：如磁带机、磁带机、光盘机

#### 按信息交换单位分
1. 块设备：如磁盘
2. 字符设备：如键盘，打印机

### 控制方式

控制设备和内存/处理机之间的数据传送。

#### 程序直接控制
每次IO时，CPU对设备状态进行循环检查。

#### 中断驱动
引入中断机制，当设备准备完成时发生中断

#### DMA
在IO设备与主存之间开辟直接数据通路，只有传送开始和结束时，才需CPU干预。

#### 通道控制

引入专门的IO处理机进行管理，是DMA方式的发展，进一步减少CPU的干预。即把对一个数据块的读/写为单位的干预，减少为对一组数据块的读/写级有关的控制和管理为单位的干预。

### IO子系统层次

#### 用户层IO软件
实现与用户交互的接口

#### 设备独立性软件
实现用户程序与设备驱动器的统一接口、设备命令、设备保护以及设备分配与释放。设备无关性，使得应用程序独立于具体使用的物理设备。

#### 设备驱动程序
与硬件直接相关，负责具体实现系统对设备发出的操作指令。 向上层用户程序提供一组标准接口。

#### 中断处理程序
用于处理中断事项

#### 硬件设备

包括一个机械部件（设备本身）和一个电子部件（控制器）


## IO核心子系统

### IO调度
确定一个好的顺序来执行这些IO请求。

### 磁盘高速缓存
1. 在内存中开辟一个单独的存储空间作为磁盘高速缓存
2. 把未利用的内存空间作为一个缓冲池，供请求分页系统和磁盘IO共享

### 缓冲区

#### 引入缓冲区的目的
1. 缓和CPU与IO设备间速度不匹配的矛盾
2. 减少对CPU的中断频率，放宽对CPU中断响应时间的限制。
3. 解决基本数据单元大小（即数据粒度）不匹配的问题
4. 提高CPU和IO设备之间的并行性。

#### 缓冲技术
1. 单缓冲
2. 双缓冲
3. 循环缓冲
4. 缓冲池

### 设备的分配与回收

#### 分类
1. 独点式使用设备：设备被使用时不再允许其他进程使用该设备
2. 分时式共享使用设备：设备没有独占使用的要求时，可以通过分时共享使用
3. SPOOLing技术：假脱机IO技术，将独占设备改造为共享设备。磁盘上开辟输入井和输出井，内存中输入缓冲区和输出缓冲区。
    + 比如共享打印机。当用户进程请求打印输出时，SPOOLing系统同意为它打印输出，但并不真正立即把打印机分配给用户进程，而只为它做两件事：1. 由输出进程在输出井中为之申请一个空闲磁盘块区，并将要打印的数据送入其中。2. 输出进程再为用户进程申请一张空白的用户请求打印表，并将用户的打印要求填入其中，再将该表挂到请求打印队列上。
    + 主要特点有：1.提高了IO速度；2.将独占设备改造为共享设备；3.实现了虚拟设备功能

#### 分配原则
既要充分发挥设备的使用效率，又要避免造成进程死锁，还要将用户程序和具体设备隔离开。

#### 分配方式
+ 静态分配：在用户作业开始执行前，由系统一次性分配该作业所要求的全部设备
+ 动态分配：在进程执行过程中根据执行需要进行分配